      TI301 â€“ Algorithmique et Structures de donnÃ©es 2

               Projet Informatique et MathÃ©matiques
          Ce projet est rÃ©digÃ© en commun avec le dÃ©partement de
                               mathÃ©matiques

              Etude de Graphes de Markov â€“ PARTIE 1

Les graphes de Markov sont des reprÃ©sentations des chaÃ®nes de Markov Ã  temps discret, un outil
trÃ¨s utile en probabilitÃ©s, et dont les applications sont trÃ¨s nombreuses. Le but de ce projet est
de rÃ©aliser des traitements automatiques sur ces graphes aï¬n dâ€™en extraire quelques
caractÃ©ristiques, et de les visualiser.



Dans ce projet ne seront prÃ©sentÃ©es que les notions thÃ©oriques essentielles pour la partie
informatique

Quâ€™est-ce quâ€™un graphe de Markov ?
Un graphe de Markov est un graphe dâ€™Ã©tats (simplement numÃ©rotÃ©s en gÃ©nÃ©ral), avec des
probabilitÃ©s de passage dâ€™un Ã©tat Ã  un autre.

Un graphe de Markov sera composÃ© de :

       Un ensemble de sommets

               Chaque sommet reprÃ©sente un Ã©tat ;

               Chaque sommet sera identiï¬Ã© par un numÃ©ro.

       Un ensemble dâ€™arÃªtes

               Chaque arÃªte relie deux sommets ;

               Chaque arÃªte possÃ¨de un poids, qui est une valeur rÃ©elle strictement positive,
               et infÃ©rieure ou Ã©gale Ã  1. Cette valeur reprÃ©sente la probabilitÃ© de passer dâ€™un
               sommet Ã  un autre (dâ€™un Ã©tat Ã  un autre) ;

               Une arÃªte peut relier un sommet Ã  lui-mÃªme.



Ce type de graphe doit de plus respecter la contrainte suivante :

La somme des probabilitÃ©s â€˜sortantesâ€™ dâ€™un sommet (de toutes les arÃªtes qui partent de ce
sommet) doit Ãªtre Ã©gale Ã  1.
ReprÃ©sentations
On reprÃ©sente classiquement ces graphes de deux maniÃ¨res.

Matrice
Par une matrice de probabilitÃ©s ğ‘€, oÃ¹ chaque valeur ğ‘€ indique la probabilitÃ© de passer de lâ€™Ã©tat
ğ‘– Ã  lâ€™Ã©tat ğ‘—. Une ligne ğ‘– correspond aux probabilitÃ©s â€˜sortantesâ€™ de lâ€™Ã©tat (ou sommet) ğ‘–

Exemple
                                           0.95 0.04 0.01  0
                                            0   0.9 0.05 0.05
                                  ğ‘€=
                                            0    0   0.8  0.2
                                            1    0    0    0


La ligne 1 indique, pour lâ€™Ã©tat 1, que :

        la probabilitÃ© de rester Ã  lâ€™Ã©tat 1 est de 0,95
        la probabilitÃ© de passer Ã  lâ€™Ã©tat 2 est de 0,04
        la probabilitÃ© de passer Ã  lâ€™Ã©tat 3 est de 0,01
        la probabilitÃ© de passer Ã  lâ€™Ã©tat 4 est de 0

On constate Ã©galement que la somme de tous les coe icients de cette ligne est bien Ã©gale Ã  1

Dessin du graphe
Par le dessin du graphe orientÃ© correspondant, oÃ¹ ces mÃªmes probabilitÃ©s sont Ã©crites sur les
arÃªtes.

Exemple de dessin du graphe associÃ© Ã  la matrice ğ‘€ ci-dessus




Câ€™est le type de dessin que vous allez produire !
Cahier des charges

Ã‰tape 1 - CrÃ©er un graphe, vÃ©riï¬er que câ€™est un graphe de Markov,
dessiner le graphe
Fichiers de donnÃ©es
Pour crÃ©er des graphes, vous disposerez de ï¬chiers de donnÃ©es, pour ne pas avoir Ã  faire de
saisies rÃ©pÃ©titives.

Ces ï¬chiers auront le format suivant :

Ligne 1 : nombre de sommets

Lignes suivantes : sommet_de_dÃ©part sommet_d_arrivÃ©e                probabilitÃ©

Exemple : toujours pour le mÃªme graphe Ã  4 sommets, le ï¬chier â€˜exemple1.txtâ€™ est donc le
suivant :
4
1   1    0.95
1   2    0.04
1   3    0.01
2   2    0.9
2   3    0.05
2   4    0.05
3   3    0.8
3   4    0.2
4   1    1

On y retrouve toutes les valeurs non nulles de la matrice M.

Structures de donnÃ©es Ã  utiliser pour stocker le graphe
Pour stocker un graphe, on pourrait utiliser un tableau 2D (une matrice) comme pour la
reprÃ©sentation matricielle â€“ cependant ces matrices pour les graphes de Markov contiennent une
majoritÃ© de 0, qui ne nous sont pas utiles pour le moment.

        ïƒ˜ La structure de donnÃ©es Ã  utiliser est donc une liste dâ€™adjacence :

Pour chaque sommet, on stocke, dans une liste chaÃ®nÃ©e (simple), les arÃªtes issues de ce
sommet, avec : le sommet dâ€™arrivÃ©e (un int), et la probabilitÃ© associÃ©e (un ï¬‚oat)

Toutes ces listes (1 par sommet), sont stockÃ©es dans un tableau.

Exemple de la liste dâ€™adjacence pour le graphe exemple
Liste      pour   le   sommet   1:[head   @]   ->   (3,   0.01) @-> (2, 0.04) @-> (1, 0.95)
Liste      pour   le   sommet   2:[head   @]   ->   (4,   0.05) @-> (3, 0.05) @-> (2, 0.90)
Liste      pour   le   sommet   3:[head   @]   ->   (4,   0.20) @-> (3, 0.80)
Liste      pour   le   sommet   4:[head   @]   ->   (1,   1.00)
structures Ã  crÃ©er
   ï‚·    une structure de type Â« cellule Â» avec : sommet dâ€™arrivÃ©e, probabilitÃ©, et pointeur vers la
        Â« cellule Â» suivante. Chaque Â« cellule Â» reprÃ©sente une arÃªte.
   ï‚·    une structure de type Â« liste Â» avec un champ Â« head Â». Chaque liste stocke toutes les
        arÃªtes â€˜sortantâ€™ dâ€™un sommet
   ï‚·    une structure Â« liste dâ€™adjacence Â» : un tableau dynamique de Â« liste Â» avec sa taille (sa
        taille Ã©tant le nombre de sommets)

fonctions Ã  crÃ©er
   ï‚·    une fonction pour crÃ©er une Â« cellule Â» ;
   ï‚·    une fonction pour crÃ©er une Â« liste Â» vide ;
   ï‚·    une fonction pour ajouter une cellule Ã  une liste ;
   ï‚·    une fonction pour a icher une liste ;
   ï‚·    une fonction pour crÃ©er une liste dâ€™adjacence â€˜videâ€™ Ã  partir dâ€™une taille donnÃ©e â€“ on crÃ©e
        le tableau de listes, chacune Ã©tant initialisÃ©e avec la liste vide ;
   ï‚·    Une fonction pour a icher une liste dâ€™adjacence.

CrÃ©er un graphe
Pour crÃ©er un graphe, utilisez un des ï¬chiers texte fournis en exemple.

voici une base de code pour vous aider Ã  e ectuer la crÃ©ation dâ€™une telle liste Ã  partir dâ€™un
ï¬chier texte :
liste_adjacence readGraph(const char *filename) {
    FILE *file = fopen(filename, "rt"); // read-only, text
    int nbvert, depart, arrivee;
    float proba;
    declarer la variable pour la liste dâ€™adjacence
    if (file==NULL)
    {
        perror("Could not open file for reading");
        exit(EXIT_FAILURE);
    }

       // first line contains number of vertices
       if (fscanf(file, "%d", &nbvert) != 1)
       {
           perror("Could not read number of vertices");
           exit(EXIT_FAILURE);
       }

    Initialiser une liste dâ€™adjacence vide Ã  partir du nombre de
sommets

       while (fscanf(file, "%d %d %f", &depart, &arrivee, &proba) == 3)
       {
           // on obtient, pour chaque ligne du fichier les valeurs
          // depart, arrivee, et proba
          Ajouter lâ€™arÃªte qui va de â€˜departâ€™ Ã  â€˜arrivÃ©eâ€™ avec la
          probabilitÃ© â€˜probaâ€™ dans la liste dâ€™adjacence
      }

      fclose(file);
      return la liste dâ€™adjacence remplie;
}


Validation de lâ€™Ã©tape 1
Vous Ãªtes capable de charger un ï¬chier texte ;

Vous Ãªtes capable dâ€™a icher la liste dâ€™adjacence.



Ã‰tape 2 â€“ VÃ©riï¬er le graphe
Vous devez vÃ©riï¬er que la somme de toutes les probabilitÃ©s â€˜sortantesâ€™ dâ€™un sommet est bien
Ã©gale Ã  1.

Puisquâ€™il sâ€™agit de valeurs de type float, il y aura parfois des arrondis : il faudra vÃ©riï¬er, en fait,
que la somme des probabilitÃ©s est comprise entre 0,99 et 1.

Ecrivez une fonction qui vÃ©riï¬e si un graphe est bien un graphe de Markov, et qui a iche les
messages :
Le graphe est un graphe de Markov
ou
Le graphe nâ€™est pas un graphe de Markov
avec les sommets en cause, par exemple
la somme des probabilitÃ©s du sommet 3 est 0.97



Validation de lâ€™Ã©tape 2
Votre programme a iche correctement les messages â€“ testez sur les di Ã©rents ï¬chiers de
donnÃ©es (certains ont Ã©tÃ© produits par ChatGPT et contiennent des erreurs).
Ã‰tape 3 â€“ Dessiner le graphe
Pour dessiner le graphe, nous allons utiliser lâ€™outil en ligne et gratuit Mermaid :
https://www.mermaidchart.com/

Cet outil nous permettra dâ€™obtenir un dessin, Ã  partir dâ€™un ï¬chier texte avec un format
spÃ©ciï¬que, assez proche de celui des ï¬chiers de donnÃ©es que nous utilisons.

Voici le ï¬chier Ã  crÃ©er, toujours pour lâ€™exemple du graphe Ã  4 sommets.
---
config:
   layout: elk
   theme: neo
   look: neo
---

flowchart LR
A((1))
B((2))
C((3))
D((4))

A   -->|0.01|C
A   -->|0.04|B
A   -->|0.95|A
B   -->|0.05|D
B   -->|0.05|C
B   -->|0.90|B
C   -->|0.20|D
C   -->|0.80|C
D   -->|1.00|A

On y retrouve :

    ï‚·   des directives de conï¬guration (Ã  conserver)
    ï‚·   Des noms de sommets (A,B,C,D),suivi des numÃ©ros Ã  a icher
    ï‚·   Les arÃªtes, avec leurs probabilitÃ©s.


Vous disposez dâ€™une fonction char *getId(int num) ; qui vous fournira une chaÃ®ne de
caractÃ¨res associÃ© Ã  un entier : Â« A Â» pour 1, Â« B Â» pour 2, â€¦, Â« Z Â» pour 26, Â« AA Â» pour 27, Â« AB Â»
pour 28,â€¦.

    ïƒ˜ Ecrivez une fonction qui prend en paramÃ¨tre une liste dâ€™adjacence (reprÃ©sentant un
      graphe), et qui produit le ï¬chier texte au format attendu.

Ensuite, copiez/collez le contenu de votre ï¬chier dans lâ€™Ã©diteur de code Mermaid.
Validation de lâ€™Ã©tape 3
A partir du ï¬chier exemple_valid_step3.txt, vous devriez obtenir le visuel suivant (aprÃ¨s
quelques manipulations trÃ¨s simples sur mermaid) :
